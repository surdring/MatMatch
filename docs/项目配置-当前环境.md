# MatMatch 项目配置 - 当前环境

**最后更新**: 2025-10-08  
**项目路径**: `D:\develop\python\MatMatch`

---

## 📁 虚拟环境

**路径**: `D:\develop\python\MatMatch\venv`

**激活命令**:
```bash
# Windows
.\venv\Scripts\activate

# 或完整路径
D:\develop\python\MatMatch\venv\Scripts\activate
```

---

## 🗄️ 数据库配置

### PostgreSQL (主数据库)
```
数据库名: matmatch
主机: 127.0.0.1
端口: 5432
用户: postgres
密码: xqxatcdj
```

**连接URL**:
```
postgresql+asyncpg://postgres:xqxatcdj@127.0.0.1:5432/matmatch
```

### Oracle ERP (数据源)
```
主机: 192.168.80.90
端口: 1521
服务名: ORCL
用户名: matmatch_read
密码: matmatch_read
```

**DSN**:
```
192.168.80.90:1521/ORCL
```

---

## ⚙️ 环境变量配置

创建文件: `backend/.env` (可选，使用默认配置可不创建)

```env
# PostgreSQL (默认配置已在代码中)
DB_HOST=127.0.0.1
DB_PORT=5432
DB_USERNAME=postgres
DB_PASSWORD=xqxatcdj
DB_DATABASE=matmatch

# Oracle (默认配置已在代码中)
ORACLE_HOST=192.168.80.90
ORACLE_PORT=1521
ORACLE_SERVICE_NAME=ORCL
ORACLE_USERNAME=matmatch_read
ORACLE_PASSWORD=matmatch_read

# 可选配置（有默认值）
ETL_BATCH_SIZE=1000
LOG_LEVEL=INFO
PROCESSOR_CACHE_TTL=5
SIMILARITY_CACHE_TTL=60
```

> 💡 **提示**: 项目已在 `backend/core/config.py` 中设置了默认配置，如无需修改可不创建 `.env` 文件。

---

## 📦 依赖安装

```bash
# 激活虚拟环境后执行
pip install -r backend/requirements.txt
pip install -r database/requirements.txt
```

---

## 🚀 快速启动

### 1. 初始化知识库
```bash
cd database
python run_full_import_verification.py
```

### 2. 运行ETL同步（可选）
```bash
.\venv\Scripts\python.exe backend\scripts\run_etl_full_sync.py
```

### 3. 运行测试
```bash
# 单元测试
pytest backend/tests/ -v

# 性能测试（需要数据库）
pytest backend/tests/integration/ -v
```

---

## ✅ 验证配置

### 检查PostgreSQL连接
```bash
python -c "from backend.database.session import get_session; import asyncio; asyncio.run(get_session().__anext__())"
```

### 检查知识库数据
```bash
python -c "
from backend.database.session import get_session
from sqlalchemy import text
import asyncio

async def check():
    async with get_session() as s:
        r = await s.execute(text('SELECT COUNT(*) FROM synonyms'))
        print(f'同义词: {r.scalar()}条')
asyncio.run(check())
"
```

---

## 📊 当前状态

- ✅ Phase 0-2 已完成
- ✅ Phase 3.1 FastAPI框架已完成
- ✅ 知识库: 6条规则 + 27,408个同义词 + 1,594个分类
- ✅ 物料数据: 168,409条（已同步）
- ✅ 测试: 106个测试全部通过（61个Phase 1-2 + 45个Phase 3.1）
- 📍 Phase 3.2 批量查重API开发中

---

## ⚠️ 注意事项

1. `.env`文件包含敏感信息，不要提交到Git
2. 首次使用需要先初始化知识库
3. Oracle连接仅用于ETL数据同步
4. 开发时建议设置 `LOG_LEVEL=DEBUG`

---

**需要帮助？** 查看完整配置指南: `docs/configuration_guide.md`

