# MatMatch é¡¹ç›®è¿ç§»æŒ‡å—

**ç›®æ ‡ä¸»æœº**: 172.16.100.211  
**è¿ç§»æ—¥æœŸ**: 2025-10-09  
**æ“ä½œç³»ç»Ÿ**: Windows

---

## ğŸ“‹ è¿ç§»å‰æ£€æŸ¥æ¸…å•

### 1. æ–°ä¸»æœºç¯å¢ƒå‡†å¤‡

- [ ] Python 3.10+ å·²å®‰è£…
- [ ] Node.js 18+ å·²å®‰è£…
- [ ] PostgreSQL 12+ å·²å®‰è£…å¹¶å¯åŠ¨
- [ ] Git å·²å®‰è£…
- [ ] ç½‘ç»œè¿æ¥æ­£å¸¸ï¼ˆèƒ½è®¿é—® Oracle: 192.168.80.90:1521ï¼‰

### 2. éœ€è¦è¿ç§»çš„æ•°æ®

- [ ] PostgreSQL æ•°æ®åº“ `matmatch`
- [ ] é¡¹ç›®ä»£ç å’Œé…ç½®
- [ ] è™šæ‹Ÿç¯å¢ƒä¾èµ–

---

## ğŸš€ è¿ç§»æ­¥éª¤

### Step 1: å¯¼å‡ºå½“å‰æ•°æ®åº“

**åœ¨æ—§ä¸»æœºä¸Šæ‰§è¡Œï¼š**

```bash
# å¯¼å‡º PostgreSQL æ•°æ®åº“
cd D:\develop\python\MatMatch

# å¯¼å‡ºæ•°æ®åº“ç»“æ„å’Œæ•°æ®
pg_dump -h 127.0.0.1 -U postgres -d matmatch -F c -b -v -f matmatch_backup_20251009.dump

# æˆ–å¯¼å‡ºä¸ºSQLæ–‡ä»¶ï¼ˆæ›´é€šç”¨ï¼‰
pg_dump -h 127.0.0.1 -U postgres -d matmatch -F p -b -v -f matmatch_backup_20251009.sql
```

**å¯¼å‡ºçš„æ–‡ä»¶ï¼š**
- `matmatch_backup_20251009.dump` (äºŒè¿›åˆ¶æ ¼å¼ï¼Œé€Ÿåº¦å¿«)
- `matmatch_backup_20251009.sql` (SQLæ ¼å¼ï¼Œå¯è¯»ï¼Œæ›´é€šç”¨)

---

### Step 2: æ‰“åŒ…é¡¹ç›®ä»£ç 

**åœ¨æ—§ä¸»æœºä¸Šæ‰§è¡Œï¼š**

```bash
cd D:\develop\python

# æ–¹æ³•1: ä½¿ç”¨ Gitï¼ˆæ¨èï¼‰
cd MatMatch
git add .
git commit -m "è¿ç§»å‰å¤‡ä»½ - 2025-10-09"
git push  # å¦‚æœæœ‰è¿œç¨‹ä»“åº“

# æ–¹æ³•2: å‹ç¼©æ‰“åŒ…
# æ’é™¤ä»¥ä¸‹ç›®å½•: venv, node_modules, __pycache__, .pytest_cache
tar -czf MatMatch_backup_20251009.tar.gz MatMatch --exclude=venv --exclude=node_modules --exclude=__pycache__ --exclude=.pytest_cache --exclude=frontend/dist

# Windows å¯ä»¥ä½¿ç”¨ 7-Zip æˆ– WinRAR æ‰‹åŠ¨å‹ç¼©
```

**éœ€è¦å¤åˆ¶åˆ°æ–°ä¸»æœºçš„æ–‡ä»¶ï¼š**
1. é¡¹ç›®ä»£ç å‹ç¼©åŒ…
2. æ•°æ®åº“å¤‡ä»½æ–‡ä»¶
3. `backend/.env` æ–‡ä»¶ï¼ˆå¦‚æœæœ‰ï¼‰

---

### Step 3: åœ¨æ–°ä¸»æœºä¸Šæ¢å¤é¡¹ç›®

#### 3.1 åˆ›å»ºé¡¹ç›®ç›®å½•

```bash
# åœ¨æ–°ä¸»æœºä¸Šåˆ›å»ºç›®å½•
cd D:\develop\python
mkdir MatMatch
cd MatMatch

# è§£å‹é¡¹ç›®æ–‡ä»¶
# ä½¿ç”¨ Git clone æˆ–è§£å‹å¤‡ä»½æ–‡ä»¶
```

#### 3.2 åˆ›å»ºPythonè™šæ‹Ÿç¯å¢ƒ

```bash
cd D:\develop\python\MatMatch

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
.\venv\Scripts\activate

# å®‰è£…åç«¯ä¾èµ–
pip install -r backend\requirements.txt

# å®‰è£…æ•°æ®åº“å·¥å…·ä¾èµ–
pip install -r database\requirements.txt
```

#### 3.3 å®‰è£…å‰ç«¯ä¾èµ–

```bash
cd frontend
npm install
cd ..
```

---

### Step 4: æ¢å¤PostgreSQLæ•°æ®åº“

#### 4.1 åˆ›å»ºæ•°æ®åº“

```bash
# ä½¿ç”¨ psql åˆ›å»ºæ•°æ®åº“
psql -h 127.0.0.1 -U postgres

# åœ¨ psql ä¸­æ‰§è¡Œ
CREATE DATABASE matmatch;
\q
```

#### 4.2 å¯¼å…¥æ•°æ®

```bash
# æ–¹æ³•1: ä» .dump æ–‡ä»¶æ¢å¤ï¼ˆæ¨èï¼Œé€Ÿåº¦å¿«ï¼‰
pg_restore -h 127.0.0.1 -U postgres -d matmatch -v matmatch_backup_20251009.dump

# æ–¹æ³•2: ä» .sql æ–‡ä»¶æ¢å¤
psql -h 127.0.0.1 -U postgres -d matmatch -f matmatch_backup_20251009.sql
```

#### 4.3 éªŒè¯æ•°æ®

```bash
psql -h 127.0.0.1 -U postgres -d matmatch

# éªŒè¯è¡¨å’Œæ•°æ®
\dt
SELECT COUNT(*) FROM materials_master;
SELECT COUNT(*) FROM synonyms;
SELECT COUNT(*) FROM extraction_rules;
\q
```

---

### Step 5: ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆIPåœ°å€ï¼‰

#### 5.1 åç«¯é…ç½®

**æ–‡ä»¶1: `backend/core/config.py`**

```python
# ä¿®æ”¹ç¬¬71è¡Œï¼ˆå¦‚éœ€å¤–ç½‘è®¿é—®ï¼‰
cors_origins: list = Field(
    default=[
        "http://localhost:3000", 
        "http://127.0.0.1:3000",
        "http://172.16.100.211:3000",  # âœ… æ·»åŠ æ–°ä¸»æœºIP
    ], 
    description="CORSå…è®¸çš„æº"
)
```

**æ–‡ä»¶2: `backend/api/middleware.py`**

```python
# ä¿®æ”¹ç¬¬173-176è¡Œ
allowed_origins = [
    "http://localhost:3000",
    "http://localhost:8080",
    "http://127.0.0.1:3000",
    "http://127.0.0.1:8080",
    "http://172.16.100.211:3000",  # âœ… æ·»åŠ æ–°ä¸»æœºIP
    "http://172.16.100.211:8080",  # âœ… æ·»åŠ æ–°ä¸»æœºIPï¼ˆå¤‡ç”¨ç«¯å£ï¼‰
]
```

**æ–‡ä»¶3: `backend/api/dependencies_auth.py` (å¦‚å¯ç”¨IPç™½åå•)**

```python
# ä¿®æ”¹ç¬¬45-47è¡Œ
IP_WHITELIST = [
    "127.0.0.1",
    "172.16.100.211",  # âœ… æ·»åŠ æ–°ä¸»æœºIP
    "192.168.1.0/24",  # å¦‚éœ€å…è®¸æ•´ä¸ªå±€åŸŸç½‘
]
```

**æ–‡ä»¶4: `backend/scripts/å¯åŠ¨åç«¯.bat`**

```batch
# ä¿®æ”¹ç¬¬91è¡Œï¼ˆå¯é€‰ï¼Œä»…æœ¬æœºè®¿é—®ç”¨127.0.0.1ï¼Œå±€åŸŸç½‘è®¿é—®ç”¨0.0.0.0ï¼‰
..\venv\Scripts\python.exe -m uvicorn api.main:app --host 0.0.0.0 --port 8000 --reload
```

#### 5.2 å‰ç«¯é…ç½®

**æ–‡ä»¶5: `frontend/vite.config.ts`**

```typescript
// ä¿®æ”¹ç¬¬34è¡Œï¼ˆå¯é€‰ï¼Œé€šå¸¸ä¸éœ€è¦ä¿®æ”¹ï¼‰
export default defineConfig({
  server: {
    host: '0.0.0.0',  // âœ… å…è®¸å±€åŸŸç½‘è®¿é—®
    port: 3000,
    proxy: {
      '/api': {
        target: 'http://172.16.100.211:8000',  // âœ… å¦‚åç«¯åœ¨ä¸åŒæœºå™¨
        changeOrigin: true
      }
    }
  }
})
```

**æ–‡ä»¶6: `scripts/å¯åŠ¨å‰ç«¯.bat`**

```batch
# ä¿®æ”¹ç¬¬61-62è¡Œï¼ˆæç¤ºä¿¡æ¯ï¼‰
echo ğŸ“¦ æœ¬æœºåœ°å€: http://localhost:3000
echo ğŸ“¦ å±€åŸŸç½‘åœ°å€: http://172.16.100.211:3000
```

---

### Step 6: æ›´æ–°æ–‡æ¡£

**æ–‡ä»¶7: `docs/é¡¹ç›®é…ç½®-å½“å‰ç¯å¢ƒ.md`**

```markdown
# æ›´æ–°ç¬¬4è¡Œ
**é¡¹ç›®è·¯å¾„**: `D:\develop\python\MatMatch`  ï¼ˆæ–°ä¸»æœºè·¯å¾„ï¼‰
**ä¸»æœºIP**: `172.16.100.211`

# æ›´æ–°ç¬¬60-65è¡Œï¼ˆå¦‚æœ‰.envæ–‡ä»¶ï¼‰
DB_HOST=127.0.0.1  ï¼ˆæœ¬æœºæ•°æ®åº“ï¼‰
# æˆ–
DB_HOST=172.16.100.211  ï¼ˆå¦‚æ•°æ®åº“åœ¨å…¶ä»–æœºå™¨ï¼‰
```

---

### Step 7: å¯åŠ¨å’ŒéªŒè¯

#### 7.1 å¯åŠ¨åç«¯

```bash
cd D:\develop\python\MatMatch

# æ–¹æ³•1: ä½¿ç”¨å¯åŠ¨è„šæœ¬
.\æ™ºèƒ½å¯åŠ¨.bat

# æ–¹æ³•2: æ‰‹åŠ¨å¯åŠ¨
cd backend
..\venv\Scripts\python.exe -m uvicorn api.main:app --host 0.0.0.0 --port 8000 --reload
```

**éªŒè¯åç«¯ï¼š**
- æœ¬æœºè®¿é—®: http://localhost:8000/docs
- å±€åŸŸç½‘è®¿é—®: http://172.16.100.211:8000/docs

#### 7.2 å¯åŠ¨å‰ç«¯

```bash
cd frontend
npm run dev
```

**éªŒè¯å‰ç«¯ï¼š**
- æœ¬æœºè®¿é—®: http://localhost:3000
- å±€åŸŸç½‘è®¿é—®: http://172.16.100.211:3000

#### 7.3 åŠŸèƒ½æµ‹è¯•

```bash
# 1. å¥åº·æ£€æŸ¥
curl http://172.16.100.211:8000/health

# 2. æµ‹è¯•æŸ¥è¯¢æ¥å£
curl -X POST http://172.16.100.211:8000/api/v1/materials/search \
  -H "Content-Type: application/json" \
  -d '{"query": "M16Ã—1.5 èºæ “", "limit": 10}'

# 3. è¿è¡Œå•å…ƒæµ‹è¯•
pytest backend/tests/ -v

# 4. æµ‹è¯•ç®¡ç†åå°
# è®¿é—® http://172.16.100.211:3000/admin
# å¯†ç : admin123
```

---

## ğŸ”§ å¸¸è§é—®é¢˜å¤„ç†

### é—®é¢˜1: ç«¯å£è¢«å ç”¨

```bash
# æ£€æŸ¥ç«¯å£å ç”¨
netstat -ano | findstr :8000
netstat -ano | findstr :3000

# åœæ­¢å ç”¨è¿›ç¨‹
.\åœæ­¢æœåŠ¡.bat
```

### é—®é¢˜2: æ•°æ®åº“è¿æ¥å¤±è´¥

```bash
# æ£€æŸ¥ PostgreSQL æœåŠ¡
services.msc

# æµ‹è¯•è¿æ¥
psql -h 127.0.0.1 -U postgres -d matmatch
```

### é—®é¢˜3: å‰ç«¯æ— æ³•è®¿é—®åç«¯API

**æ£€æŸ¥CORSé…ç½®ï¼š**
1. ç¡®è®¤ `backend/core/config.py` ä¸­åŒ…å«å‰ç«¯åœ°å€
2. ç¡®è®¤ `backend/api/middleware.py` ä¸­å…è®¸å‰ç«¯æº
3. é‡å¯åç«¯æœåŠ¡

### é—®é¢˜4: è™šæ‹Ÿç¯å¢ƒè·¯å¾„é—®é¢˜

```bash
# å¦‚æœè™šæ‹Ÿç¯å¢ƒè·¯å¾„ä¸å¯¹ï¼Œé‡æ–°åˆ›å»º
cd D:\develop\python\MatMatch
rmdir /s venv
python -m venv venv
.\venv\Scripts\activate
pip install -r backend\requirements.txt
pip install -r database\requirements.txt
```

### é—®é¢˜5: Oracleè¿æ¥å¤±è´¥ï¼ˆETLåŒæ­¥ï¼‰

```bash
# æµ‹è¯•Oracleè¿æ¥
python database\test_oracle_connection.py

# å¦‚æœç½‘ç»œä¸é€šï¼Œæ£€æŸ¥ï¼š
ping 192.168.80.90
telnet 192.168.80.90 1521
```

---

## ğŸ“Š è¿ç§»åéªŒè¯æ¸…å•

- [ ] PostgreSQL æ•°æ®åº“å·²æ¢å¤
- [ ] åç«¯APIæ­£å¸¸å¯åŠ¨ (http://172.16.100.211:8000/docs)
- [ ] å‰ç«¯ç•Œé¢æ­£å¸¸è®¿é—® (http://172.16.100.211:3000)
- [ ] ç®¡ç†åå°ç™»å½•æˆåŠŸ
- [ ] æŸ¥è¯¢åŠŸèƒ½æ­£å¸¸
- [ ] æ‰¹é‡æŸ¥é‡åŠŸèƒ½æ­£å¸¸
- [ ] ETLåŒæ­¥åŠŸèƒ½æ­£å¸¸ï¼ˆå¦‚éœ€è¦ï¼‰
- [ ] å•å…ƒæµ‹è¯•å…¨éƒ¨é€šè¿‡

---

## ğŸ” å®‰å…¨å»ºè®®

### 1. é˜²ç«å¢™é…ç½®

```bash
# Windows é˜²ç«å¢™è§„åˆ™
# å…è®¸ 8000 ç«¯å£ï¼ˆåç«¯APIï¼‰
netsh advfirewall firewall add rule name="MatMatch Backend" dir=in action=allow protocol=TCP localport=8000

# å…è®¸ 3000 ç«¯å£ï¼ˆå‰ç«¯ï¼‰
netsh advfirewall firewall add rule name="MatMatch Frontend" dir=in action=allow protocol=TCP localport=3000

# å…è®¸ 5432 ç«¯å£ï¼ˆPostgreSQLï¼Œå¦‚éœ€è¿œç¨‹è®¿é—®ï¼‰
netsh advfirewall firewall add rule name="PostgreSQL" dir=in action=allow protocol=TCP localport=5432
```

### 2. PostgreSQLè¿œç¨‹è®¿é—®é…ç½®ï¼ˆå¯é€‰ï¼‰

**å¦‚æœéœ€è¦è¿œç¨‹è®¿é—®PostgreSQLï¼š**

ç¼–è¾‘ `postgresql.conf`:
```conf
listen_addresses = '*'  # æˆ– '172.16.100.211'
```

ç¼–è¾‘ `pg_hba.conf`:
```conf
host    matmatch        postgres        172.16.100.0/24         md5
```

### 3. ç”Ÿäº§ç¯å¢ƒå»ºè®®

```bash
# 1. ä¿®æ”¹æ•°æ®åº“å¯†ç 
ALTER USER postgres WITH PASSWORD 'new_strong_password';

# 2. æ›´æ–° backend/.env
DB_PASSWORD=new_strong_password

# 3. ä¿®æ”¹ç®¡ç†åå°Token
# backend/api/dependencies_auth.py
ADMIN_DEV_TOKEN = "your_production_token_here"

# 4. å…³é—­è°ƒè¯•æ¨¡å¼
# backend/api/main.py
# ç§»é™¤ --reload å‚æ•°
```

---

## ğŸ“ è¿ç§»æ£€æŸ¥è¡¨

### æ•°æ®è¿ç§»

- [ ] PostgreSQL æ•°æ®åº“å·²å¤‡ä»½
- [ ] æ•°æ®åº“å·²æˆåŠŸæ¢å¤åˆ°æ–°ä¸»æœº
- [ ] æ•°æ®å®Œæ•´æ€§éªŒè¯é€šè¿‡

### ä»£ç è¿ç§»

- [ ] é¡¹ç›®ä»£ç å·²å¤åˆ¶åˆ°æ–°ä¸»æœº
- [ ] Pythonè™šæ‹Ÿç¯å¢ƒå·²åˆ›å»º
- [ ] æ‰€æœ‰ä¾èµ–å·²å®‰è£…ï¼ˆbackend + database + frontendï¼‰

### é…ç½®ä¿®æ”¹

- [ ] `backend/core/config.py` - CORS origins
- [ ] `backend/api/middleware.py` - allowed_origins
- [ ] `backend/api/dependencies_auth.py` - IPç™½åå•ï¼ˆå¯é€‰ï¼‰
- [ ] `backend/å¯åŠ¨åç«¯.bat` - hostå‚æ•°
- [ ] `frontend/vite.config.ts` - server.hostï¼ˆå¯é€‰ï¼‰
- [ ] `scripts/å¯åŠ¨å‰ç«¯.bat` - æç¤ºä¿¡æ¯
- [ ] `docs/é¡¹ç›®é…ç½®-å½“å‰ç¯å¢ƒ.md` - è·¯å¾„å’ŒIP

### åŠŸèƒ½éªŒè¯

- [ ] åç«¯APIæ–‡æ¡£å¯è®¿é—®
- [ ] å‰ç«¯é¡µé¢æ­£å¸¸æ˜¾ç¤º
- [ ] æŸ¥è¯¢åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] æ‰¹é‡æŸ¥é‡åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] ç®¡ç†åå°åŠŸèƒ½æ­£å¸¸
- [ ] ETLåŒæ­¥åŠŸèƒ½æ­£å¸¸ï¼ˆå¦‚éœ€è¦ï¼‰

---

## ğŸ¯ å¿«é€Ÿè¿ç§»å‘½ä»¤æ±‡æ€»

```bash
# ============ æ—§ä¸»æœº ============
# 1. å¯¼å‡ºæ•°æ®åº“
pg_dump -h 127.0.0.1 -U postgres -d matmatch -F c -b -v -f matmatch_backup.dump

# 2. æ‰“åŒ…ä»£ç ï¼ˆæ’é™¤å¤§æ–‡ä»¶ï¼‰
# ä½¿ç”¨å‹ç¼©å·¥å…·æ‰“åŒ…ï¼Œæ’é™¤: venv, node_modules, __pycache__

# ============ æ–°ä¸»æœº ============
# 3. è§£å‹ä»£ç 
# æ‰‹åŠ¨è§£å‹åˆ° D:\develop\python\MatMatch

# 4. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒå¹¶å®‰è£…ä¾èµ–
cd D:\develop\python\MatMatch
python -m venv venv
.\venv\Scripts\activate
pip install -r backend\requirements.txt
pip install -r database\requirements.txt

# 5. å®‰è£…å‰ç«¯ä¾èµ–
cd frontend
npm install
cd ..

# 6. æ¢å¤æ•°æ®åº“
psql -h 127.0.0.1 -U postgres -c "CREATE DATABASE matmatch;"
pg_restore -h 127.0.0.1 -U postgres -d matmatch -v matmatch_backup.dump

# 7. ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼ˆå‚è€ƒä¸Šæ–‡"Step 5"ï¼‰

# 8. å¯åŠ¨æœåŠ¡
.\æ™ºèƒ½å¯åŠ¨.bat

# 9. éªŒè¯åŠŸèƒ½
# è®¿é—® http://172.16.100.211:8000/docs
# è®¿é—® http://172.16.100.211:3000
```

---

## ğŸ“ æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. `.gemini_logs/` ç›®å½•ä¸‹çš„æ—¥å¿—æ–‡ä»¶
2. `backend/logs/` ç›®å½•ä¸‹çš„åº”ç”¨æ—¥å¿—
3. PostgreSQL æ—¥å¿—

---

**è¿ç§»å®Œæˆæ—¶é—´**: _______  
**éªŒè¯äºº**: _______  
**å¤‡æ³¨**: _______

