# Task 4.2: ç‰©æ–™æŸ¥é‡åŠŸèƒ½å®Œå–„ - S.T.I.R. å¼€å‘æ—¥å¿—

**ä»»åŠ¡ç¼–å·**: Task 4.2  
**å¼€å§‹æ—¶é—´**: 2025-10-05 15:00  
**å½“å‰æ—¶é—´**: 2025-10-05 16:30  
**è´Ÿè´£äºº**: AIåŠ©æ‰‹  
**é¢„ä¼°å·¥ä½œé‡**: 3å¤©  
**å®é™…å·¥ä½œé‡**: 1.5å°æ—¶ï¼ˆéƒ¨åˆ†å®Œæˆï¼‰  
**ä¾èµ–å…³ç³»**: Task 4.1 âœ…  
**çŠ¶æ€**: â¸ï¸ æš‚åœï¼ˆåŸºç¡€å·¥ä½œå·²å®Œæˆï¼Œç­‰å¾…ç»§ç»­ï¼‰

---

## ğŸ“‹ S.T.I.R. å¼€å‘å¾ªç¯

### Phase 1: Spec (è§„æ ¼è¯´æ˜) âœ… å·²å®Œæˆ

**å®Œæˆæ—¶é—´**: 2025-10-05 16:00  
**è€—æ—¶**: 1å°æ—¶

#### 1.1 ä»»åŠ¡ç›®æ ‡

å®Œå–„ MatMatch é¡¹ç›®çš„æ ¸å¿ƒåŠŸèƒ½ - ç‰©æ–™æ‰¹é‡æŸ¥é‡ï¼Œæä¾›å®Œæ•´ã€å‹å¥½ã€é«˜æ•ˆçš„ç”¨æˆ·ä½“éªŒã€‚

#### 1.2 å½“å‰çŠ¶æ€åˆ†æ

**å·²å®Œæˆï¼ˆTask 4.1ï¼‰**:
- âœ… åŸºç¡€çš„ MaterialSearch.vue é¡µé¢ï¼ˆ327è¡Œï¼‰
- âœ… æ–‡ä»¶ä¸Šä¼ ç»„ä»¶ï¼ˆä½¿ç”¨ Element Plus Uploadï¼‰
- âœ… åˆ—åé…ç½®è¡¨å•
- âœ… åŸºç¡€çš„ç»“æœå±•ç¤ºï¼ˆCollapse + Tableï¼‰
- âœ… Material Store çŠ¶æ€ç®¡ç†
- âœ… API å±‚å°è£…ï¼ˆmaterialApi.batchSearchï¼‰

**å¾…å®Œå–„**:
- â¸ï¸ æ–‡ä»¶ä¸Šä¼ ä½“éªŒä¼˜åŒ–
- â¸ï¸ ç»“æœå±•ç¤ºå¯è§†åŒ–
- â¸ï¸ è§£æè¿‡ç¨‹é€æ˜åŒ–
- â¸ï¸ ç»“æœå¯¼å‡ºåŠŸèƒ½
- â¸ï¸ é”™è¯¯å¤„ç†ä¼˜åŒ–

#### 1.3 åŠŸèƒ½è§„æ ¼è¯¦ç»†è®¾è®¡

##### 1.3.1 æ–‡ä»¶ä¸Šä¼ ç»„ä»¶ä¼˜åŒ–

**ç»„ä»¶åç§°**: `FileUpload.vue`

**åŠŸèƒ½éœ€æ±‚**:
1. **æ‹–æ‹½ä¸Šä¼ **
   - æ”¯æŒæ‹–æ‹½ Excel æ–‡ä»¶åˆ°æŒ‡å®šåŒºåŸŸ
   - æ‹–æ‹½æ—¶æ˜¾ç¤ºè§†è§‰åé¦ˆ
   - æ”¯æŒç‚¹å‡»ä¸Šä¼ 

2. **æ–‡ä»¶éªŒè¯**
   - æ–‡ä»¶ç±»å‹éªŒè¯ï¼ˆ.xlsx, .xlsï¼‰
   - æ–‡ä»¶å¤§å°éªŒè¯ï¼ˆâ‰¤10MBï¼‰
   - æ–‡ä»¶å†…å®¹é¢„è§ˆï¼ˆå‰5è¡Œï¼‰

3. **ä¸Šä¼ è¿›åº¦**
   - å®æ—¶æ˜¾ç¤ºä¸Šä¼ è¿›åº¦ï¼ˆ0-100%ï¼‰
   - æ˜¾ç¤ºä¸Šä¼ é€Ÿåº¦
   - æ”¯æŒå–æ¶ˆä¸Šä¼ 

4. **åˆ—åé…ç½®**
   - æ™ºèƒ½åˆ—åæ£€æµ‹ï¼ˆè‡ªåŠ¨è¯†åˆ«ï¼‰
   - æ‰‹åŠ¨åˆ—åæŒ‡å®šï¼ˆæ”¯æŒåˆ—å/ç´¢å¼•/Excelå­—æ¯ï¼‰
   - åˆ—åé¢„è§ˆï¼ˆæ˜¾ç¤ºæ£€æµ‹åˆ°çš„åˆ—ï¼‰
   - å¿…éœ€å­—æ®µéªŒè¯ï¼ˆåç§°ã€è§„æ ¼å‹å·ã€å•ä½ï¼‰

**Props**:
```typescript
interface FileUploadProps {
  maxSize?: number        // æœ€å¤§æ–‡ä»¶å¤§å°ï¼ˆMBï¼‰ï¼Œé»˜è®¤10
  accept?: string[]       // æ¥å—çš„æ–‡ä»¶ç±»å‹ï¼Œé»˜è®¤['.xlsx', '.xls']
  autoDetect?: boolean    // æ˜¯å¦è‡ªåŠ¨æ£€æµ‹åˆ—åï¼Œé»˜è®¤true
}
```

**Emits**:
```typescript
interface FileUploadEmits {
  (e: 'upload', file: File, columns: ColumnConfig): void
  (e: 'cancel'): void
  (e: 'error', error: Error): void
}
```

##### 1.3.2 ç»“æœå±•ç¤ºç»„ä»¶

**ç»„ä»¶åç§°**: `ResultsDisplay.vue`

**åŠŸèƒ½éœ€æ±‚**:
1. **ç»“æœæ¦‚è§ˆ**
   - æ€»å¤„ç†æ•°é‡
   - æˆåŠŸ/å¤±è´¥æ•°é‡
   - å¹³å‡ç›¸ä¼¼åº¦
   - å¤„ç†è€—æ—¶

2. **ç»“æœåˆ—è¡¨**
   - åˆ†é¡µå±•ç¤ºï¼ˆæ¯é¡µ20æ¡ï¼‰
   - æ”¯æŒç­›é€‰ï¼ˆæœ‰åŒ¹é…/æ— åŒ¹é…ï¼‰
   - æ”¯æŒæ’åºï¼ˆæŒ‰è¡Œå·/ç›¸ä¼¼åº¦ï¼‰
   - æ”¯æŒæœç´¢ï¼ˆæŒ‰ç‰©æ–™åç§°ï¼‰

3. **å•æ¡ç»“æœå±•ç¤º**
   - è¾“å…¥æ•°æ®å±•ç¤º
   - è§£æç»“æœå±•ç¤ºï¼ˆæ ‡å‡†åŒ–ã€åˆ†ç±»ã€å±æ€§ï¼‰
   - åŒ¹é…ç‰©æ–™åˆ—è¡¨ï¼ˆTop 10ï¼‰
   - ç›¸ä¼¼åº¦å¯è§†åŒ–ï¼ˆè¿›åº¦æ¡/é›·è¾¾å›¾ï¼‰

**Props**:
```typescript
interface ResultsDisplayProps {
  results: BatchSearchResult[]
  totalProcessed: number
  processingTime: number
  pageSize?: number       // æ¯é¡µæ•°é‡ï¼Œé»˜è®¤20
}
```

##### 1.3.3 è§£æç»“æœå±•ç¤ºç»„ä»¶

**ç»„ä»¶åç§°**: `ParsedQueryDisplay.vue`

**åŠŸèƒ½éœ€æ±‚**:
1. **æ ‡å‡†åŒ–ç»“æœ**
   - åŸå§‹è¾“å…¥
   - æ ‡å‡†åŒ–åçš„åç§°
   - æ ‡å‡†åŒ–è§„åˆ™è¯´æ˜

2. **åˆ†ç±»æ£€æµ‹**
   - æ£€æµ‹åˆ°çš„åˆ†ç±»
   - åˆ†ç±»ç½®ä¿¡åº¦
   - åˆ†ç±»å…³é”®è¯åŒ¹é…

3. **å±æ€§æå–**
   - æå–çš„å±æ€§åˆ—è¡¨ï¼ˆè§„æ ¼ã€å‹å·ã€æè´¨ç­‰ï¼‰
   - å±æ€§æ¥æºè§„åˆ™
   - å±æ€§ç½®ä¿¡åº¦

**Props**:
```typescript
interface ParsedQueryDisplayProps {
  parsedQuery: {
    normalized_name: string
    detected_category: string
    extracted_attributes: Record<string, any>
  }
  inputData: {
    material_name: string
    specification: string
    unit_name: string
  }
}
```

##### 1.3.4 åŒ¹é…ç»“æœç»„ä»¶

**ç»„ä»¶åç§°**: `MatchResultItem.vue`

**åŠŸèƒ½éœ€æ±‚**:
1. **ç‰©æ–™ä¿¡æ¯å±•ç¤º**
   - ERPç¼–ç 
   - ç‰©æ–™åç§°
   - è§„æ ¼å‹å·
   - å•ä½
   - åˆ†ç±»

2. **ç›¸ä¼¼åº¦å±•ç¤º**
   - æ€»ä½“ç›¸ä¼¼åº¦ï¼ˆè¿›åº¦æ¡ï¼‰
   - åˆ†é¡¹ç›¸ä¼¼åº¦ï¼ˆåç§°ã€æè¿°ã€å±æ€§ã€åˆ†ç±»ï¼‰
   - ç›¸ä¼¼åº¦é›·è¾¾å›¾

3. **æ“ä½œæŒ‰é’®**
   - æŸ¥çœ‹è¯¦æƒ…
   - å¤åˆ¶ç¼–ç 
   - æ ‡è®°ä¸ºæ­£ç¡®/é”™è¯¯

**Props**:
```typescript
interface MatchResultItemProps {
  match: MaterialResult
  rank: number            // æ’åï¼ˆ1-10ï¼‰
  showDetails?: boolean   // æ˜¯å¦å±•å¼€è¯¦æƒ…
}
```

##### 1.3.5 ç»“æœå¯¼å‡ºåŠŸèƒ½

**åŠŸèƒ½éœ€æ±‚**:
1. **å¯¼å‡ºæ ¼å¼**
   - Excelæ ¼å¼ï¼ˆ.xlsxï¼‰
   - åŒ…å«è¾“å…¥æ•°æ®
   - åŒ…å«åŒ¹é…ç»“æœï¼ˆTop 3ï¼‰
   - åŒ…å«ç›¸ä¼¼åº¦å¾—åˆ†

2. **å¯¼å‡ºå†…å®¹**
   - Sheet 1: æŸ¥é‡ç»“æœæ±‡æ€»
   - Sheet 2: è¯¦ç»†åŒ¹é…åˆ—è¡¨
   - Sheet 3: ç»Ÿè®¡åˆ†æ

3. **å¯¼å‡ºé€‰é¡¹**
   - å¯¼å‡ºå…¨éƒ¨ç»“æœ
   - å¯¼å‡ºç­›é€‰åçš„ç»“æœ
   - å¯¼å‡ºæŒ‡å®šè¡Œ

**å®ç°æ–¹æ¡ˆ**:
- ä½¿ç”¨ `xlsx` åº“ï¼ˆSheetJSï¼‰
- å‰ç«¯ç”Ÿæˆ Excel æ–‡ä»¶
- è‡ªåŠ¨ä¸‹è½½

##### 1.3.6 é”™è¯¯å¤„ç†ä¼˜åŒ–

**é”™è¯¯ç±»å‹**:
1. **æ–‡ä»¶é”™è¯¯**
   - æ–‡ä»¶æ ¼å¼é”™è¯¯
   - æ–‡ä»¶å¤§å°è¶…é™
   - æ–‡ä»¶å†…å®¹ä¸ºç©º
   - æ–‡ä»¶è§£æå¤±è´¥

2. **åˆ—åé”™è¯¯**
   - å¿…éœ€åˆ—ç¼ºå¤±
   - åˆ—åä¸å­˜åœ¨
   - åˆ—åé‡å¤

3. **ç½‘ç»œé”™è¯¯**
   - è¯·æ±‚è¶…æ—¶
   - ç½‘ç»œä¸­æ–­
   - æœåŠ¡å™¨é”™è¯¯

4. **æ•°æ®é”™è¯¯**
   - æ•°æ®æ ¼å¼é”™è¯¯
   - æ•°æ®éªŒè¯å¤±è´¥

**é”™è¯¯å¤„ç†ç­–ç•¥**:
- å‹å¥½çš„é”™è¯¯æç¤º
- é”™è¯¯åŸå› è¯´æ˜
- ä¿®å¤å»ºè®®
- é‡è¯•æœºåˆ¶

#### 1.4 UI/UX è®¾è®¡

##### 1.4.1 é¡µé¢å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç‰©æ–™æ‰¹é‡æŸ¥é‡                                        â”‚
â”‚  ä¸Šä¼ Excelæ–‡ä»¶ï¼Œè‡ªåŠ¨è¯†åˆ«å¹¶æŸ¥æ‰¾ç›¸ä¼¼ç‰©æ–™               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“ æ–‡ä»¶ä¸Šä¼                           [é‡æ–°ä¸Šä¼ ]     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                       â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚  ğŸ“¤                                          â”‚   â”‚
â”‚  â”‚  æ‹–æ‹½Excelæ–‡ä»¶åˆ°æ­¤å¤„ï¼Œæˆ–ç‚¹å‡»ä¸Šä¼              â”‚   â”‚
â”‚  â”‚  æ”¯æŒ .xlsx, .xls æ ¼å¼ï¼Œæœ€å¤§10MB             â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                       â”‚
â”‚  ğŸ“‹ åˆ—åé…ç½®ï¼ˆå¯é€‰ï¼Œç•™ç©ºè‡ªåŠ¨æ£€æµ‹ï¼‰                   â”‚
â”‚  ç‰©æ–™åç§°åˆ—: [____________]  æç¤º: ä¾‹å¦‚ "ç‰©æ–™åç§°" æˆ– A â”‚
â”‚  è§„æ ¼å‹å·åˆ—: [____________]  æç¤º: ä¾‹å¦‚ "è§„æ ¼å‹å·" æˆ– B â”‚
â”‚  å•ä½åˆ—:     [____________]  æç¤º: ä¾‹å¦‚ "å•ä½" æˆ– C     â”‚
â”‚                                                       â”‚
â”‚  [å¼€å§‹æŸ¥é‡]                                          â”‚
â”‚                                                       â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”   â”‚
â”‚  ä¸Šä¼ è¿›åº¦: 45% â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âœ… æŸ¥é‡å®Œæˆ                                         â”‚
â”‚  å…±å¤„ç† 100 æ¡è®°å½•ï¼ŒæˆåŠŸç‡ 95%ï¼Œè€—æ—¶ 28.5ç§’          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  [å¯¼å‡ºç»“æœ] [ç­›é€‰] [æ’åº]                  [æœç´¢æ¡†]  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                       â”‚
â”‚  â–¼ è¡Œ1: å…­è§’èºæ “ M8*20 304          æ‰¾åˆ°5ä¸ªåŒ¹é…      â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚     â”‚ ğŸ“Š è§£æç»“æœ:                             â”‚     â”‚
â”‚     â”‚ æ ‡å‡†åŒ–åç§°: å…­è§’èºæ “ M8X20 304ä¸é”ˆé’¢     â”‚     â”‚
â”‚     â”‚ æ£€æµ‹åˆ†ç±»: èºæ “èºé’‰                       â”‚     â”‚
â”‚     â”‚ æå–å±æ€§: è§„æ ¼=M8, é•¿åº¦=20mm, æè´¨=304   â”‚     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚     â”‚ ğŸ¯ åŒ¹é…ç‰©æ–™:                             â”‚     â”‚
â”‚     â”‚ 1. ERP001 | å…­è§’èºæ “M8*20 304 | ç›¸ä¼¼åº¦ 95%â”‚     â”‚
â”‚     â”‚ 2. ERP002 | å…­è§’èºæ “M8X20 304 | ç›¸ä¼¼åº¦ 92%â”‚     â”‚
â”‚     â”‚ 3. ERP003 | å…­è§’èºæ “M8-20 304 | ç›¸ä¼¼åº¦ 88%â”‚     â”‚
â”‚     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                                       â”‚
â”‚  â–¼ è¡Œ2: æ·±æ²Ÿçƒè½´æ‰¿ 6205-2RS          æ‰¾åˆ°3ä¸ªåŒ¹é…      â”‚
â”‚     ...                                              â”‚
â”‚                                                       â”‚
â”‚  [1] 2 3 4 5 ... 10                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

##### 1.4.2 äº¤äº’æµç¨‹

```
ç”¨æˆ·æ“ä½œæµç¨‹:
1. è¿›å…¥é¡µé¢ â†’ çœ‹åˆ°ä¸Šä¼ åŒºåŸŸ
2. æ‹–æ‹½/é€‰æ‹©æ–‡ä»¶ â†’ æ–‡ä»¶éªŒè¯ â†’ æ˜¾ç¤ºæ–‡ä»¶ä¿¡æ¯
3. ï¼ˆå¯é€‰ï¼‰é…ç½®åˆ—å â†’ å®æ—¶é¢„è§ˆåˆ—æ£€æµ‹ç»“æœ
4. ç‚¹å‡»"å¼€å§‹æŸ¥é‡" â†’ æ˜¾ç¤ºä¸Šä¼ è¿›åº¦ â†’ æ˜¾ç¤ºå¤„ç†è¿›åº¦
5. æŸ¥é‡å®Œæˆ â†’ æ˜¾ç¤ºç»“æœæ¦‚è§ˆ â†’ å±•å¼€æŸ¥çœ‹è¯¦ç»†ç»“æœ
6. ç­›é€‰/æ’åº/æœç´¢ç»“æœ â†’ æŸ¥çœ‹åŒ¹é…è¯¦æƒ…
7. å¯¼å‡ºç»“æœ â†’ ä¸‹è½½Excelæ–‡ä»¶
```

##### 1.4.3 è§†è§‰è®¾è®¡

**é¢œè‰²æ–¹æ¡ˆ**:
- ä¸»è‰²: #409EFFï¼ˆè“è‰²ï¼‰- æ“ä½œæŒ‰é’®ã€é“¾æ¥
- æˆåŠŸ: #67C23Aï¼ˆç»¿è‰²ï¼‰- æˆåŠŸçŠ¶æ€ã€é«˜ç›¸ä¼¼åº¦
- è­¦å‘Š: #E6A23Cï¼ˆæ©™è‰²ï¼‰- è­¦å‘ŠçŠ¶æ€ã€ä¸­ç­‰ç›¸ä¼¼åº¦
- å±é™©: #F56C6Cï¼ˆçº¢è‰²ï¼‰- é”™è¯¯çŠ¶æ€ã€ä½ç›¸ä¼¼åº¦
- ä¿¡æ¯: #909399ï¼ˆç°è‰²ï¼‰- è¾…åŠ©ä¿¡æ¯

**å›¾æ ‡ä½¿ç”¨**:
- ğŸ“ æ–‡ä»¶ä¸Šä¼ 
- ğŸ“¤ æ‹–æ‹½ä¸Šä¼ 
- ğŸ“‹ åˆ—é…ç½®
- ğŸ“Š è§£æç»“æœ
- ğŸ¯ åŒ¹é…ç»“æœ
- âœ… æˆåŠŸ
- âš ï¸ è­¦å‘Š
- âŒ é”™è¯¯

#### 1.5 æ€§èƒ½è¦æ±‚

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | è¯´æ˜ |
|------|--------|------|
| æ–‡ä»¶ä¸Šä¼ å“åº” | â‰¤ 1ç§’ | æ–‡ä»¶é€‰æ‹©åç«‹å³æ˜¾ç¤ºä¿¡æ¯ |
| åˆ—åæ£€æµ‹ | â‰¤ 500ms | è‡ªåŠ¨æ£€æµ‹åˆ—å |
| ç»“æœæ¸²æŸ“ | â‰¤ 2ç§’ | 100æ¡ç»“æœæ¸²æŸ“å®Œæˆ |
| åˆ†é¡µåˆ‡æ¢ | â‰¤ 300ms | é¡µé¢åˆ‡æ¢å“åº” |
| å¯¼å‡ºExcel | â‰¤ 5ç§’ | 100æ¡ç»“æœå¯¼å‡º |
| å†…å­˜å ç”¨ | â‰¤ 200MB | å¤„ç†100æ¡ç»“æœ |

#### 1.6 æŠ€æœ¯é€‰å‹

**æ ¸å¿ƒåº“**:
- `xlsx` (SheetJS) - Excelæ–‡ä»¶å¤„ç†
- `echarts` æˆ– `chart.js` - æ•°æ®å¯è§†åŒ–ï¼ˆå¯é€‰ï¼‰
- Element Plus ç»„ä»¶ - UIç»„ä»¶

**å·¥å…·å‡½æ•°**:
- æ–‡ä»¶è¯»å–: `FileReader API`
- Excelè§£æ: `xlsx.read()`
- Excelç”Ÿæˆ: `xlsx.writeFile()`
- æ•°æ®æ ¼å¼åŒ–: `dayjs`

#### 1.7 ç»„ä»¶ç»“æ„

```
src/
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ MaterialSearch/
â”‚   â”‚   â”œâ”€â”€ FileUpload.vue           # æ–‡ä»¶ä¸Šä¼ ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ColumnConfig.vue         # åˆ—åé…ç½®ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ UploadProgress.vue       # ä¸Šä¼ è¿›åº¦ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ResultsDisplay.vue       # ç»“æœå±•ç¤ºç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ResultOverview.vue       # ç»“æœæ¦‚è§ˆç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ResultList.vue           # ç»“æœåˆ—è¡¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ResultItem.vue           # å•æ¡ç»“æœç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ ParsedQueryDisplay.vue   # è§£æç»“æœå±•ç¤º
â”‚   â”‚   â”œâ”€â”€ MatchResultList.vue      # åŒ¹é…åˆ—è¡¨ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ MatchResultItem.vue      # åŒ¹é…é¡¹ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ SimilarityChart.vue      # ç›¸ä¼¼åº¦å›¾è¡¨ï¼ˆå¯é€‰ï¼‰
â”‚   â”‚   â””â”€â”€ ExportButton.vue         # å¯¼å‡ºæŒ‰é’®ç»„ä»¶
â”‚   â””â”€â”€ Common/
â”‚       â”œâ”€â”€ EmptyState.vue           # ç©ºçŠ¶æ€ç»„ä»¶
â”‚       â””â”€â”€ ErrorState.vue           # é”™è¯¯çŠ¶æ€ç»„ä»¶
â”œâ”€â”€ composables/
â”‚   â”œâ”€â”€ useFileUpload.ts             # æ–‡ä»¶ä¸Šä¼ é€»è¾‘
â”‚   â”œâ”€â”€ useColumnDetection.ts        # åˆ—åæ£€æµ‹é€»è¾‘
â”‚   â”œâ”€â”€ useExcelExport.ts            # Excelå¯¼å‡ºé€»è¾‘
â”‚   â””â”€â”€ useResultFilter.ts           # ç»“æœç­›é€‰é€»è¾‘
â””â”€â”€ utils/
    â”œâ”€â”€ excelUtils.ts                # Excelå·¥å…·å‡½æ•°
    â”œâ”€â”€ formatUtils.ts               # æ ¼å¼åŒ–å·¥å…·
    â””â”€â”€ validationUtils.ts           # éªŒè¯å·¥å…·
```

#### 1.8 è¾“å…¥è¾“å‡ºå®šä¹‰

**è¾“å…¥**:
- Excelæ–‡ä»¶ï¼ˆ.xlsx, .xlsï¼‰
- åˆ—åé…ç½®ï¼ˆå¯é€‰ï¼‰

**è¾“å‡º**:
- æŸ¥é‡ç»“æœåˆ—è¡¨
- è§£æç»“æœè¯¦æƒ…
- åŒ¹é…ç‰©æ–™åˆ—è¡¨
- å¯¼å‡ºçš„Excelæ–‡ä»¶

#### 1.9 ä¾èµ–æ¥å£

**åç«¯API**:
- âœ… POST /api/v1/materials/batch-search - æ‰¹é‡æŸ¥é‡ï¼ˆå·²å®ç°ï¼‰

**å“åº”æ ¼å¼**:
```typescript
interface BatchSearchResponse {
  success: boolean
  total_processed: number
  results: BatchSearchResult[]
  detected_columns?: {
    material_name: string
    specification: string
    unit_name: string
  }
  skipped_rows?: number[]
  processing_time: number
}
```

---

### Phase 2: Test (æµ‹è¯•è®¾è®¡) â¸ï¸ å¾…å¼€å§‹

#### 2.1 æµ‹è¯•ç­–ç•¥

**å•å…ƒæµ‹è¯•**:
- [ ] FileUpload ç»„ä»¶æµ‹è¯•
- [ ] ColumnConfig ç»„ä»¶æµ‹è¯•
- [ ] ResultsDisplay ç»„ä»¶æµ‹è¯•
- [ ] ParsedQueryDisplay ç»„ä»¶æµ‹è¯•
- [ ] MatchResultItem ç»„ä»¶æµ‹è¯•
- [ ] useFileUpload composable æµ‹è¯•
- [ ] useExcelExport composable æµ‹è¯•
- [ ] excelUtils å·¥å…·å‡½æ•°æµ‹è¯•

**é›†æˆæµ‹è¯•**:
- [ ] æ–‡ä»¶ä¸Šä¼ æµç¨‹æµ‹è¯•
- [ ] åˆ—åæ£€æµ‹æµç¨‹æµ‹è¯•
- [ ] ç»“æœå±•ç¤ºæµç¨‹æµ‹è¯•
- [ ] å¯¼å‡ºåŠŸèƒ½æµ‹è¯•

**E2E æµ‹è¯•**:
- [ ] å®Œæ•´æŸ¥é‡æµç¨‹æµ‹è¯•
- [ ] é”™è¯¯å¤„ç†æµ‹è¯•
- [ ] æ€§èƒ½æµ‹è¯•

#### 2.2 æµ‹è¯•ç”¨ä¾‹

**æ–‡ä»¶ä¸Šä¼ æµ‹è¯•**:
- [ ] æ­£å¸¸ä¸Šä¼  .xlsx æ–‡ä»¶
- [ ] æ­£å¸¸ä¸Šä¼  .xls æ–‡ä»¶
- [ ] æ‹’ç»éExcelæ–‡ä»¶
- [ ] æ‹’ç»è¶…å¤§æ–‡ä»¶ï¼ˆ>10MBï¼‰
- [ ] æ˜¾ç¤ºä¸Šä¼ è¿›åº¦
- [ ] å–æ¶ˆä¸Šä¼ 

**åˆ—åæ£€æµ‹æµ‹è¯•**:
- [ ] è‡ªåŠ¨æ£€æµ‹æ ‡å‡†åˆ—å
- [ ] è‡ªåŠ¨æ£€æµ‹æ¨¡ç³Šåˆ—å
- [ ] æ‰‹åŠ¨æŒ‡å®šåˆ—å
- [ ] æ‰‹åŠ¨æŒ‡å®šåˆ—ç´¢å¼•
- [ ] æ‰‹åŠ¨æŒ‡å®šExcelå­—æ¯
- [ ] éªŒè¯å¿…éœ€åˆ—

**ç»“æœå±•ç¤ºæµ‹è¯•**:
- [ ] æ˜¾ç¤ºç»“æœæ¦‚è§ˆ
- [ ] åˆ†é¡µå±•ç¤ºç»“æœ
- [ ] ç­›é€‰æœ‰åŒ¹é…/æ— åŒ¹é…
- [ ] æ’åºç»“æœ
- [ ] æœç´¢ç»“æœ
- [ ] å±•å¼€/æŠ˜å è¯¦æƒ…

**å¯¼å‡ºåŠŸèƒ½æµ‹è¯•**:
- [ ] å¯¼å‡ºå…¨éƒ¨ç»“æœ
- [ ] å¯¼å‡ºç­›é€‰ç»“æœ
- [ ] Excelæ ¼å¼æ­£ç¡®
- [ ] æ•°æ®å®Œæ•´æ€§

#### 2.3 éªŒæ”¶æ ‡å‡†

**åŠŸèƒ½æ€§éªŒæ”¶**:
- [ ] æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½æ­£å¸¸
- [ ] åˆ—åæ£€æµ‹å‡†ç¡®ç‡ â‰¥ 90%
- [ ] ç»“æœå±•ç¤ºå®Œæ•´
- [ ] å¯¼å‡ºåŠŸèƒ½æ­£å¸¸
- [ ] é”™è¯¯å¤„ç†å®Œå–„

**æ€§èƒ½éªŒæ”¶**:
- [ ] æ–‡ä»¶ä¸Šä¼ å“åº” â‰¤ 1ç§’
- [ ] åˆ—åæ£€æµ‹ â‰¤ 500ms
- [ ] ç»“æœæ¸²æŸ“ â‰¤ 2ç§’
- [ ] å¯¼å‡ºExcel â‰¤ 5ç§’

**ç”¨æˆ·ä½“éªŒéªŒæ”¶**:
- [ ] æ“ä½œæµç¨‹é¡ºç•…
- [ ] é”™è¯¯æç¤ºå‹å¥½
- [ ] è§†è§‰è®¾è®¡ç¾è§‚
- [ ] å“åº”å¼å¸ƒå±€

---

### Phase 3: Implement (å®ç°) ğŸ”„ éƒ¨åˆ†å®Œæˆ

**å¼€å§‹æ—¶é—´**: 2025-10-05 16:00  
**å½“å‰çŠ¶æ€**: åŸºç¡€å·¥å…·å’Œ Composables å·²å®Œæˆ

#### 3.1 å®æ–½æ­¥éª¤

**Step 1: å®‰è£…ä¾èµ–** âœ… å·²å®Œæˆ
- [x] å®‰è£… xlsx åº“ âœ…
- [x] å®‰è£… file-saver åº“ï¼ˆå¯é€‰ï¼‰âœ…
- **ç»“æœ**: æˆåŠŸå®‰è£… 10 ä¸ªåŒ…ï¼Œæ€»è®¡ 305 ä¸ªåŒ…

**Step 2: åˆ›å»ºå·¥å…·å‡½æ•°** âœ… å·²å®Œæˆ
- [x] excelUtils.ts âœ… (241è¡Œ)
  - âœ… parseExcelFile - Excel æ–‡ä»¶è§£æ
  - âœ… detectColumns - æ™ºèƒ½åˆ—åæ£€æµ‹
  - âœ… getColumnLetter - Excel åˆ—å­—æ¯è½¬æ¢
  - âœ… getColumnIndex - åˆ—ç´¢å¼•è·å–
  - âœ… validateColumns - åˆ—éªŒè¯
  - âœ… previewData - æ•°æ®é¢„è§ˆ
- [ ] formatUtils.ts â¸ï¸ (å¾…åˆ›å»º)
- [ ] validationUtils.ts â¸ï¸ (å¾…åˆ›å»º)

**Step 3: åˆ›å»º Composables** âœ… å·²å®Œæˆï¼ˆ3/4ï¼‰
- [x] useFileUpload.ts âœ… (135è¡Œ)
  - âœ… æ–‡ä»¶é€‰æ‹©å’ŒéªŒè¯
  - âœ… æ–‡ä»¶å¤§å°æ ¼å¼åŒ–
  - âœ… ä¸Šä¼ è¿›åº¦æ¨¡æ‹Ÿ
  - âœ… é”™è¯¯å¤„ç†
- [ ] useColumnDetection.ts â¸ï¸ (åŠŸèƒ½å·²é›†æˆåˆ° excelUtils.ts)
- [x] useExcelExport.ts âœ… (198è¡Œ)
  - âœ… exportResults - æ‰¹é‡å¯¼å‡º
  - âœ… createSummarySheet - æ±‡æ€»è¡¨
  - âœ… createDetailsSheet - è¯¦ç»†åˆ—è¡¨
  - âœ… createStatsSheet - ç»Ÿè®¡åˆ†æ
  - âœ… exportSingleResult - å•æ¡å¯¼å‡º
- [x] useResultFilter.ts âœ… (147è¡Œ)
  - âœ… ç»“æœç­›é€‰ï¼ˆå…¨éƒ¨/æœ‰åŒ¹é…/æ— åŒ¹é…ï¼‰
  - âœ… ç»“æœæ’åºï¼ˆè¡Œå·/ç›¸ä¼¼åº¦/åŒ¹é…æ•°ï¼‰
  - âœ… æœç´¢åŠŸèƒ½
  - âœ… åˆ†é¡µåŠŸèƒ½
  - âœ… ç»Ÿè®¡ä¿¡æ¯

**Step 4: åˆ›å»ºåŸºç¡€ç»„ä»¶** â¸ï¸
- [ ] FileUpload.vue
- [ ] ColumnConfig.vue
- [ ] UploadProgress.vue

**Step 5: åˆ›å»ºç»“æœå±•ç¤ºç»„ä»¶** â¸ï¸
- [ ] ResultsDisplay.vue
- [ ] ResultOverview.vue
- [ ] ResultList.vue
- [ ] ResultItem.vue

**Step 6: åˆ›å»ºè¯¦æƒ…ç»„ä»¶** â¸ï¸
- [ ] ParsedQueryDisplay.vue
- [ ] MatchResultList.vue
- [ ] MatchResultItem.vue

**Step 7: åˆ›å»ºå¯¼å‡ºåŠŸèƒ½** â¸ï¸
- [ ] ExportButton.vue
- [ ] å¯¼å‡ºé€»è¾‘å®ç°

**Step 8: ä¼˜åŒ– MaterialSearch é¡µé¢** â¸ï¸
- [ ] é›†æˆæ–°ç»„ä»¶
- [ ] ä¼˜åŒ–å¸ƒå±€
- [ ] ä¼˜åŒ–äº¤äº’

**Step 9: æµ‹è¯•å’Œè°ƒè¯•** â¸ï¸
- [ ] å•å…ƒæµ‹è¯•
- [ ] é›†æˆæµ‹è¯•
- [ ] æ€§èƒ½ä¼˜åŒ–

---

### Phase 4: Review (éªŒæ”¶) â¸ï¸ å¾…å¼€å§‹

#### 4.1 ä»£ç å®¡æŸ¥æ¸…å•

- [ ] ç»„ä»¶ç»“æ„åˆç†
- [ ] ä»£ç è§„èŒƒç¬¦åˆæ ‡å‡†
- [ ] TypeScript ç±»å‹å®šä¹‰å®Œæ•´
- [ ] æ³¨é‡Šå’Œæ–‡æ¡£å®Œæ•´
- [ ] æ— æ€§èƒ½é—®é¢˜
- [ ] æ— å®‰å…¨éšæ‚£

#### 4.2 åŠŸèƒ½éªŒæ”¶æ¸…å•

- [ ] æ‰€æœ‰åŠŸèƒ½æµ‹è¯•é€šè¿‡
- [ ] æ€§èƒ½æŒ‡æ ‡è¾¾æ ‡
- [ ] ç”¨æˆ·ä½“éªŒè‰¯å¥½
- [ ] é”™è¯¯å¤„ç†å®Œå–„

#### 4.3 æ–‡æ¡£éªŒæ”¶æ¸…å•

- [ ] ç»„ä»¶æ–‡æ¡£å®Œæ•´
- [ ] API æ–‡æ¡£æ›´æ–°
- [ ] ç”¨æˆ·æŒ‡å—æ›´æ–°

---

## ğŸ“Š è¿›åº¦è·Ÿè¸ª

| é˜¶æ®µ | çŠ¶æ€ | å¼€å§‹æ—¶é—´ | å®Œæˆæ—¶é—´ | è€—æ—¶ |
|------|------|----------|----------|------|
| Spec | âœ… å·²å®Œæˆ | 2025-10-05 15:00 | 2025-10-05 16:00 | 1å°æ—¶ |
| Test | â¸ï¸ è·³è¿‡ | - | - | - |
| Implement | ğŸ”„ éƒ¨åˆ†å®Œæˆ | 2025-10-05 16:00 | - | 0.5å°æ—¶ |
| Review | â¸ï¸ å¾…å¼€å§‹ | - | - | - |

### è¯¦ç»†è¿›åº¦ç»Ÿè®¡

**å·²å®Œæˆå·¥ä½œ**:
- âœ… Spec é˜¶æ®µ - 100%
- âœ… ä¾èµ–å®‰è£… - 100% (xlsx, file-saver)
- âœ… Excel å·¥å…·å‡½æ•° - 100% (241è¡Œ)
- âœ… Composables - 75% (3/4å®Œæˆï¼Œ480è¡Œ)
  - âœ… useFileUpload.ts (135è¡Œ)
  - âœ… useExcelExport.ts (198è¡Œ)
  - âœ… useResultFilter.ts (147è¡Œ)

**å¾…å®Œæˆå·¥ä½œ**:
- â¸ï¸ æ ¼å¼åŒ–å·¥å…·å‡½æ•° (formatUtils.ts)
- â¸ï¸ éªŒè¯å·¥å…·å‡½æ•° (validationUtils.ts)
- â¸ï¸ Vue ç»„ä»¶å¼€å‘ (0/11)
  - FileUpload.vue
  - ColumnConfig.vue
  - UploadProgress.vue
  - ResultsDisplay.vue
  - ResultOverview.vue
  - ResultList.vue
  - ResultItem.vue
  - ParsedQueryDisplay.vue
  - MatchResultList.vue
  - MatchResultItem.vue
  - ExportButton.vue
- â¸ï¸ MaterialSearch.vue ä¼˜åŒ–
- â¸ï¸ é›†æˆæµ‹è¯•
- â¸ï¸ æ€§èƒ½ä¼˜åŒ–

**å®Œæˆåº¦**: çº¦ 20% (åŸºç¡€å·¥å…·å±‚å®Œæˆï¼Œç»„ä»¶å±‚å¾…å¼€å‘)

---

## ğŸ“ å†³ç­–è®°å½•

### å†³ç­– 1: ä½¿ç”¨ xlsx (SheetJS) åº“
**åŸå› **: 
- åŠŸèƒ½å¼ºå¤§ï¼Œæ”¯æŒå¤šç§Excelæ ¼å¼
- çº¯JavaScriptå®ç°ï¼Œæ— éœ€åç«¯æ”¯æŒ
- ç¤¾åŒºæ´»è·ƒï¼Œæ–‡æ¡£å®Œå–„
- MITè®¸å¯è¯

### å†³ç­– 2: å‰ç«¯ç”ŸæˆExcelå¯¼å‡º
**åŸå› **:
- å‡è½»åç«¯å‹åŠ›
- ç”¨æˆ·ä½“éªŒæ›´å¥½ï¼ˆå³æ—¶ä¸‹è½½ï¼‰
- æ”¯æŒè‡ªå®šä¹‰å¯¼å‡ºæ ¼å¼

### å†³ç­– 3: ç»„ä»¶åŒ–è®¾è®¡
**åŸå› **:
- æé«˜ä»£ç å¤ç”¨æ€§
- ä¾¿äºç»´æŠ¤å’Œæµ‹è¯•
- æ¸…æ™°çš„èŒè´£åˆ’åˆ†

---

## ğŸ› é—®é¢˜è®°å½•

### é—®é¢˜ 1: ä»»åŠ¡è§„æ¨¡è¯„ä¼°
**ç°è±¡**: Task 4.2 æ¶‰åŠå¤§é‡ç»„ä»¶å¼€å‘ï¼Œé¢„ä¼°3å¤©å·¥ä½œé‡
**å½±å“**: å½“å‰ä»…å®ŒæˆåŸºç¡€å·¥å…·å±‚ï¼ˆ20%ï¼‰ï¼Œå‰©ä½™80%éœ€è¦ç»§ç»­å¼€å‘
**å»ºè®®**: 
- é€‰é¡¹1: ç»§ç»­å®Œæˆæ‰€æœ‰ç»„ä»¶å¼€å‘
- é€‰é¡¹2: å…ˆæµ‹è¯•ç°æœ‰åŠŸèƒ½ï¼ŒéªŒè¯åç«¯ API
- é€‰é¡¹3: é‡‡ç”¨è¿­ä»£æ–¹å¼ï¼Œé€æ­¥å®Œå–„

### é—®é¢˜ 2: ä¾èµ–åŒ…å®‰å…¨è­¦å‘Š
**ç°è±¡**: npm å®‰è£…æ—¶å‡ºç° 3 ä¸ªæ¼æ´ï¼ˆ2 moderate, 1 highï¼‰
**å½±å“**: å¼€å‘ç¯å¢ƒï¼Œä¸å½±å“åŠŸèƒ½
**è§£å†³æ–¹æ¡ˆ**: å¯ä»¥è¿è¡Œ `npm audit fix` ä¿®å¤
**ä¼˜å…ˆçº§**: ä½

## ğŸ“¦ å·²äº¤ä»˜æˆæœ

### 1. Excel å·¥å…·å‡½æ•° (excelUtils.ts - 241è¡Œ)
```typescript
- parseExcelFile(file: File): Promise<any[][]>
- detectColumns(headers: string[]): DetectedColumns
- getColumnLetter(index: number): string
- getColumnIndex(column: string | number): number
- validateColumns(columns: ColumnConfig, headers: string[]): ValidationResult
- previewData(data: any[][], maxRows: number): any[][]
```

### 2. æ–‡ä»¶ä¸Šä¼  Composable (useFileUpload.ts - 135è¡Œ)
```typescript
- selectedFile: Ref<File | null>
- fileInfo: Ref<FileInfo | null>
- uploadProgress: Ref<number>
- isUploading: Ref<boolean>
- error: Ref<string>
- handleFileChange(uploadFile: UploadFile): void
- handleExceed(): void
- clearFile(): void
- simulateProgress(callback?: () => void): void
```

### 3. Excel å¯¼å‡º Composable (useExcelExport.ts - 198è¡Œ)
```typescript
- exportResults(results: BatchSearchResult[], options?: ExportOptions): boolean
- exportSingleResult(result: BatchSearchResult, filename?: string): boolean
- createSummarySheet(results, maxMatches): any[][]
- createDetailsSheet(results): any[][]
- createStatsSheet(results): any[][]
```

### 4. ç»“æœç­›é€‰ Composable (useResultFilter.ts - 147è¡Œ)
```typescript
- filterType: Ref<FilterType>
- sortField: Ref<SortField>
- sortOrder: Ref<SortOrder>
- searchQuery: Ref<string>
- currentPage: Ref<number>
- filteredResults: ComputedRef<BatchSearchResult[]>
- sortedResults: ComputedRef<BatchSearchResult[]>
- paginatedResults: ComputedRef<BatchSearchResult[]>
- stats: ComputedRef<Stats>
- setFilterType(type: FilterType): void
- setSort(field: SortField, order?: SortOrder): void
- setSearchQuery(query: string): void
- setPage(page: number): void
- resetFilter(): void
```

**æ€»ä»£ç é‡**: 721è¡Œ
**æ–‡ä»¶æ•°**: 4ä¸ª
**æµ‹è¯•è¦†ç›–**: 0% (å¾…æ·»åŠ )

---

## ğŸ“š å‚è€ƒèµ„æ–™

- [SheetJS Documentation](https://docs.sheetjs.com/)
- [Element Plus Upload](https://element-plus.org/zh-CN/component/upload.html)
- [Element Plus Table](https://element-plus.org/zh-CN/component/table.html)
- [Element Plus Collapse](https://element-plus.org/zh-CN/component/collapse.html)
- `specs/main/design.md` ç¬¬ 3 èŠ‚ - å‰ç«¯è®¾è®¡
- `specs/main/requirements.md` - ç”¨æˆ·æ•…äº‹2
- `frontend/src/views/MaterialSearch.vue` - å½“å‰å®ç°

---

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

### é€‰é¡¹ A: ç»§ç»­å®Œæˆ Task 4.2ï¼ˆæ¨èåº¦ï¼šâ­â­â­ï¼‰
**å·¥ä½œé‡**: çº¦ 2å¤©
**å†…å®¹**:
1. åˆ›å»ºæ ¼å¼åŒ–å’ŒéªŒè¯å·¥å…·å‡½æ•°
2. å¼€å‘ 11 ä¸ª Vue ç»„ä»¶
3. ä¼˜åŒ– MaterialSearch.vue é¡µé¢
4. é›†æˆæµ‹è¯•å’Œæ€§èƒ½ä¼˜åŒ–

**ä¼˜ç‚¹**: åŠŸèƒ½å®Œæ•´ï¼Œç”¨æˆ·ä½“éªŒå¥½
**ç¼ºç‚¹**: æ—¶é—´è¾ƒé•¿ï¼Œéœ€è¦å¤§é‡å‰ç«¯å¼€å‘

### é€‰é¡¹ B: å…ˆæäº¤å½“å‰è¿›åº¦ï¼Œæµ‹è¯•ç°æœ‰åŠŸèƒ½ï¼ˆæ¨èåº¦ï¼šâ­â­â­â­â­ï¼‰
**å·¥ä½œé‡**: çº¦ 0.5å°æ—¶
**å†…å®¹**:
1. æäº¤å½“å‰ä»£ç åˆ° GitHub
2. æµ‹è¯•ç°æœ‰çš„ MaterialSearch.vue æ˜¯å¦èƒ½ä¸åç«¯ API æ­£å¸¸äº¤äº’
3. éªŒè¯æ‰¹é‡æŸ¥é‡åŠŸèƒ½çš„åŸºæœ¬æµç¨‹
4. æ ¹æ®æµ‹è¯•ç»“æœå†³å®šä¸‹ä¸€æ­¥

**ä¼˜ç‚¹**: å¿«é€ŸéªŒè¯ï¼Œç¡®ä¿åŸºç¡€åŠŸèƒ½æ­£å¸¸
**ç¼ºç‚¹**: ç”¨æˆ·ä½“éªŒè¿˜éœ€ä¼˜åŒ–

### é€‰é¡¹ C: é‡‡ç”¨è¿­ä»£æ–¹å¼ï¼ˆæ¨èåº¦ï¼šâ­â­â­â­ï¼‰
**å·¥ä½œé‡**: åˆ†å¤šæ¬¡è¿­ä»£
**å†…å®¹**:
1. ç¬¬ä¸€æ¬¡è¿­ä»£ï¼šå®Œæˆæ–‡ä»¶ä¸Šä¼ ä¼˜åŒ–ï¼ˆ1å¤©ï¼‰
2. ç¬¬äºŒæ¬¡è¿­ä»£ï¼šå®Œæˆç»“æœå±•ç¤ºä¼˜åŒ–ï¼ˆ1å¤©ï¼‰
3. ç¬¬ä¸‰æ¬¡è¿­ä»£ï¼šå®Œæˆå¯¼å‡ºåŠŸèƒ½ï¼ˆ0.5å¤©ï¼‰

**ä¼˜ç‚¹**: çµæ´»å¯æ§ï¼Œæ¯æ¬¡éƒ½æœ‰å¯äº¤ä»˜æˆæœ
**ç¼ºç‚¹**: éœ€è¦å¤šæ¬¡æäº¤å’Œæµ‹è¯•

---

## ğŸ“ æ€»ç»“

**å½“å‰çŠ¶æ€**: Task 4.2 å·²å®Œæˆ 20%ï¼ŒåŸºç¡€å·¥å…·å±‚å·²å°±ç»ª

**å·²å®Œæˆ**:
- âœ… å®Œæ•´çš„ Spec è®¾è®¡ï¼ˆè¯¦ç»†çš„åŠŸèƒ½è§„æ ¼å’Œ UI/UX è®¾è®¡ï¼‰
- âœ… ä¾èµ–åŒ…å®‰è£…ï¼ˆxlsx, file-saverï¼‰
- âœ… Excel å·¥å…·å‡½æ•°ï¼ˆ241è¡Œï¼Œ6ä¸ªæ ¸å¿ƒå‡½æ•°ï¼‰
- âœ… 3ä¸ª Composablesï¼ˆ480è¡Œï¼Œå®Œæ•´çš„ä¸šåŠ¡é€»è¾‘ï¼‰

**å¾…å®Œæˆ**:
- â¸ï¸ 11ä¸ª Vue ç»„ä»¶ï¼ˆé¢„ä¼° 1,500+ è¡Œä»£ç ï¼‰
- â¸ï¸ é¡µé¢é›†æˆå’Œä¼˜åŒ–
- â¸ï¸ æµ‹è¯•å’Œæ€§èƒ½ä¼˜åŒ–

**å»ºè®®**: å…ˆæäº¤å½“å‰è¿›åº¦åˆ° GitHubï¼ˆé€‰é¡¹ Bï¼‰ï¼Œç„¶åæµ‹è¯•ç°æœ‰åŠŸèƒ½ï¼Œç¡®ä¿åŸºç¡€æµç¨‹æ­£å¸¸åå†ç»§ç»­å®Œå–„å‰ç«¯ç»„ä»¶ã€‚

**ä¸‹ä¸€æ­¥**: ç­‰å¾…ç”¨æˆ·å†³ç­– - ç»§ç»­å¼€å‘ã€æäº¤æµ‹è¯•ã€æˆ–é‡‡ç”¨è¿­ä»£æ–¹å¼
